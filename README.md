# 발전소용 날씨 예측 보정 딥러닝 모델

## 프로젝트 개요
- 정확한 기상 예보는 발전소 운영의 효율성과 안전성에 직결.
- 하지만 날씨 예측은 매우 복잡하고 어려운 작업이며, 수치예보 모델은 방대한 관측 데이터를 이용해 계산.
- 실제로 수치예보 결과에는 체계적인 오차(bias)가 나타날 수 있으며, 딥러닝 기반 보정 모델을 통해 관측값과 예보값 간 오차를 학습하고 예측 정확도를 높임.
- 예보된 기상 변수(온도, 습도, 기압 등)를 보정하여 발전량 예측의 신뢰도를 향상시키도록 설계.

## 환경 설정
### 필요한 Python 라이브러리는 프로젝트 루트의 requirements.txt 파일에 명시되어 있습니다. 다음 명령어로 패키지를 일괄 설치하세요:

pip install -r requirements.txt
위 명령은 requirements.txt에 기록된 패키지들을 설치합니다.

Python 3.10–3.12 버전과 호환되며, 해당 버전 중 하나를 사용하시기 바랍니다.
가상환경(virtual environment)을 사용하면 패키지 충돌을 방지할 수 있습니다.

## 파일 준비 및 실행 순서
모델 실행 전에 입력 파일을 준비하고, 다음 순서대로 스크립트를 실행합니다:
### 데이터 준비:
- input/obs.csv(관측치)
- input/fcst.csv(예측치)

두 파일을 input/ 폴더에 위치시킵니다. 두 파일 모두 동일한 날짜(time) 범위를 가져야 합니다.
예시로 파일을 준비해 두었으니 참고 하면 됩니다.

### 전처리 실행:
python dataset/inputprocess.py
스크립트를 실행하여 데이터를 전처리합니다.

이 스크립트는 관측치와 예보치를 결합/정제하여 input/base_data.csv 파일을 생성합니다.


### 예측 실행:
전처리된 데이터를 이용해

python predict.py를 실행하면 보정된 예측 결과가 생성됩니다.

실행 결과는 output/prediction.csv 파일로 저장됩니다.

이 순서대로 실행하지 않으면 필요한 데이터가 생성되지 않아 오류가 발생할 수 있습니다.

### 입력 데이터 형식 주의사항
입력 파일(obs.csv, fcst.csv)에는 날짜(date) 칼럼과 주요 변수들이 반드시 포함되어야 합니다.
예시로 준비된 파일과 모든 칼럼명이 동일하게 있어야 합니다.

date 칼럼: 예측 대상 날짜/시간(YYYY-MM-DD HH:MM 등)
degC_obs 등 온도 관련 칼럼: 섭씨온도(℃) 값을 갖습니다.
humid_obs 등 습도 관련 칼럼: 상대습도(%) 값을 갖습니다.
mmHg_obs 등 기압 관련 칼럼: 수은주 기압(mmHg) 값을 갖습니다.

### Online Learning(Fine Tune) 옵션
predict.py에는 --train 옵션이 있어 기존 사전 학습된 모델을 추가로 학습할 수 있습니다.
이 옵션을 사용하면 관측값과 예보값 간 오차를 줄이도록 모델이 미세 조정됩니다.

python predict.py --train

Expanding Window 방식으로 학습된 모델을 예측하려는 시기에 맞게 추가 학습하여 예측 정확도를 향상시키는 데 도움이 됩니다.

온라인 학습을 수행하지 않으면 작은 오차가 보정되지 않아 예측 결과가 크게 차이 납니다.

학습을 실행하면 logs/ 디렉토리에 학습 로그와 체크포인트 파일이 생성됩니다.


### 디렉토리 구조 및 사용 방법

프로젝트 폴더 전체를 압축 해제한 후, 해당 폴더 안에서 명령어를 실행해야 합니다. 경로 지정은 상대경로 기반이므로, 폴더 구조를 변경하거나 다른 경로에서 실행하면 파일을 찾지 못해 오류가 발생할 수 있습니다.

프로젝트 구조는 다음과 같습니다:

<프로젝트 루트>
├─ input/
│   ├─ obs.csv        # 관측치 입력 파일
│   ├─ fcst.csv       # 예보치 입력 파일
│   └─ base_data.csv  # 전처리 결과 (자동 생성)
├─ dataset/
│   └─ inputprocess.py  # 전처리 스크립트
├─ base_ckpts/
│   └─ ...            # 사전 학습된 모델 체크포인트
├─ artifacts/
│   └─ full_ds.pkl     # 사전 준비된 데이터셋
├─ predict.py         # 예측 실행 스크립트
├─ requirements.txt   # 패키지 목록
└─ output/
    └─ prediction.csv  # 예측 결과 (생성)

artifacts/full_ds.pkl, base_ckpts/ 등은 미리 학습된 모델과 설정 파일들이 들어 있으므로 삭제하거나 변경하지 마십시오.

### 출력 결과 예시와 해석
예측 실행 후 생성되는 output/prediction.csv는 다음과 같은 구조를 갖습니다. 각 행은 한 시점의 예측 결과를 나타냅니다.
date	humid_obs	degC_obs	mmHg_obs
2025-07-14 12:00	60.1	25.3	761.2
2025-07-14 13:00	58.4	24.8	760.9
...	...	...	...

date: 예측된 시점의 날짜/시간 (예: 2025-07-14 12:00)
humid_obs: 해당 시점의 습도(%) 예측값
degC_obs: 해당 시점의 기온(℃) 예측값
mmHg_obs: 해당 시점의 기압(mmHg) 예측값
위 예에서 날짜는 예측 시점, humid_obs는 상대습도(%), degC_obs는 기온(℃), mmHg_obs는 (mmHg) 단위의 기압 예측치를 나타냅니다.
